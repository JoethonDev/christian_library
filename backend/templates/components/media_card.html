<!-- templates/components/media_card.html - Coptic Orthodox Theme -->
{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}
<div class="col-12 col-md-6 col-lg-4">
    <div class="card card-coptic h-100 hover-maroon-glow media-card" style="overflow: hidden; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);">
        <div class="ratio ratio-16x9 position-relative overflow-hidden">
            {% if item.meta and item.meta.thumbnail %}
                <img src="{{ item.meta.thumbnail.url }}" class="object-fit-cover w-100 h-100" loading="lazy" style="transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);">
            {% elif item.thumbnail %}
                <img src="{{ item.thumbnail.url }}" class="object-fit-cover w-100 h-100" loading="lazy" style="transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);">
            {% else %}
                <div class="d-flex align-items-center justify-content-center h-100" style="background: var(--color-off-white);">
                    {% if item.content_type == 'video' %}
                        <i class="bi bi-play-circle text-maroon" style="font-size: 2.5rem;"></i>
                    {% elif item.content_type == 'audio' %}
                        <i class="bi bi-music-note-beamed text-golden" style="font-size: 2.5rem;"></i>
                    {% else %}
                        <i class="bi bi-journal-bookmark text-maroon" style="font-size: 2.5rem;"></i>
                    {% endif %}
                </div>
            {% endif %}
            
            <!-- Content Type Badge -->
            <div class="position-absolute top-0 end-0 m-2 m-md-3">
                <span class="badge rounded-pill px-2 px-md-3 py-1 py-md-2 fw-medium sacred-shadow" style="
                    {% if item.content_type == 'video' %}background: var(--color-maroon);
                    {% elif item.content_type == 'audio' %}background: var(--color-golden-ochre);
                    {% else %}background: var(--color-maroon);{% endif %}
                    color: white; font-size: 0.75rem; border: 1px solid var(--color-golden-ochre);">
                    {% if item.content_type == 'video' %}<i class="bi bi-play me-1" style="font-size: 0.75rem;"></i>
                    {% elif item.content_type == 'audio' %}<i class="bi bi-music-note me-1" style="font-size: 0.75rem;"></i>
                    {% else %}<i class="bi bi-file-text me-1" style="font-size: 0.75rem;"></i>{% endif %}
                    {{ item.get_content_type_display }}
                </span>
            </div>
            
            <!-- Play Overlay -->
            <div class="position-absolute top-50 start-50 translate-middle play-overlay" style="opacity: 0; transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);">
                <div class="d-flex align-items-center justify-content-center sacred-shadow" 
                     style="width: 48px; height: 48px; background: rgba(255, 255, 255, 0.95); border-radius: 50%; border: 2px solid var(--color-golden-ochre);">
                    <i class="bi bi-play-fill text-maroon" style="font-size: 1.25rem; margin-left: 2px;"></i>
                </div>
            </div>
        </div>
        
        <div class="card-body p-3 p-md-4">
            <div class="mb-2">
                {% if item.tags.exists %}
                    {% for tag in item.tags.all %}
                    <span class="badge rounded-pill me-1 mb-1" style="background: var(--color-golden-ochre-10); color: var(--color-maroon); font-size: 0.7rem; font-weight: 600; border: 1px solid var(--color-golden-ochre);">
                        {% if LANGUAGE_CODE == 'ar' %}
                            {{ tag.name_ar|default:tag.name_en }}
                        {% else %}
                            {{ tag.name_en|default:tag.name_ar }}
                        {% endif %}
                    </span>
                    {% endfor %}
                {% else %}
                <span class="badge rounded-pill mb-1" style="background: var(--color-golden-ochre-10); color: var(--color-maroon); font-size: 0.7rem; font-weight: 600; border: 1px solid var(--color-golden-ochre);">
                    {% trans "Uncategorized" %}
                </span>
                {% endif %}
            </div>
            <h5 class="card-title heading-font text-maroon fw-bold mb-2 mb-md-3" style="line-height: 1.3; font-size: clamp(1rem, 2.5vw, 1.125rem);">
                {{ item.title|truncatechars:60 }}
            </h5>
            {% if item.headline %}
            <div class="search-highlight-snippet mb-2 small body-font text-muted" style="line-height: 1.5; font-size: 0.875rem;">
                {{ item.headline|safe }}
            </div>
            {% elif item.description %}
            <p class="card-text small body-font text-muted mb-2 mb-md-3 d-none d-md-block" style="line-height: 1.4; font-size: 0.875rem;">
                {{ item.description|truncatechars:100 }}
            </p>
            {% endif %}
            
            <div class="d-flex align-items-center justify-content-between flex-wrap gap-2">
                <small class="body-font text-muted" style="font-size: 0.8rem;">
                    <i class="bi bi-clock me-1 text-golden" style="font-size: 0.8rem;"></i>{{ item.created_at|timesince }} {% trans "ago" %}
                </small>
                <a href="{% if item.content_type == 'video' %}{% url 'frontend_api:video_detail' item.id %}{% elif item.content_type == 'audio' %}{% url 'frontend_api:audio_detail' item.id %}{% else %}{% url 'frontend_api:pdf_detail' item.id %}{% endif %}" 
                   class="btn btn-primary rounded-pill px-3 px-md-4 btn-sm stretched-link body-font fw-medium" style="min-height: 36px; font-size: 0.875rem;">
                    {% trans "View" %} <i class="bi bi-arrow-right ms-1" style="font-size: 0.875rem;"></i>
                </a>
            </div>
        </div>
    </div>
</div>

<style>
.media-card:hover {
    transform: translateY(-4px);
}

.media-card:hover img {
    transform: scale(1.05);
}

.media-card:hover .play-overlay {
    opacity: 1 !important;
}
</style>